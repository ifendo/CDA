<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Analysis of Covariance | Clinical Data Analysis</title>
  <meta name="description" content="Jie’s daily work summary as a clinical statistical programmer." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Analysis of Covariance | Clinical Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Jie’s daily work summary as a clinical statistical programmer." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Analysis of Covariance | Clinical Data Analysis" />
  
  <meta name="twitter:description" content="Jie’s daily work summary as a clinical statistical programmer." />
  

<meta name="author" content="Jie Wang" />


<meta name="date" content="2020-12-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="the-binomial-test.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#discrete-distributions"><i class="fa fa-check"></i><b>2.1</b> Discrete Distributions</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#continuous-distributions"><i class="fa fa-check"></i><b>2.2</b> Continuous Distributions</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#one-sample-t-test"><i class="fa fa-check"></i><b>2.3</b> One-Sample t-Test</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#sas-example"><i class="fa fa-check"></i><b>2.3.1</b> SAS example</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#test-of-normality-shapiro---wilk-test"><i class="fa fa-check"></i><b>2.3.2</b> Test of normality: Shapiro - Wilk test</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#paired-t-test"><i class="fa fa-check"></i><b>2.4</b> Paired-t test</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#two-sample-t-test"><i class="fa fa-check"></i><b>2.5</b> Two-sample t-Test</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#reference-table-and-figure"><i class="fa fa-check"></i><b>2.6</b> Reference table and figure</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>3</b> One-Way ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#sas-example-1"><i class="fa fa-check"></i><b>3.1</b> SAS example</a></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#sample-result"><i class="fa fa-check"></i><b>3.2</b> Sample Result</a><ul>
<li class="chapter" data-level="3.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#pairwise-t-test"><i class="fa fa-check"></i><b>3.2.1</b> Pairwise t-test</a></li>
<li class="chapter" data-level="3.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#dunnetts-test"><i class="fa fa-check"></i><b>3.2.2</b> Dunnett’s test</a></li>
<li class="chapter" data-level="3.2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#side-by-side"><i class="fa fa-check"></i><b>3.2.3</b> side-by-side</a></li>
<li class="chapter" data-level="3.2.4" data-path="one-way-anova.html"><a href="one-way-anova.html#some-notes"><i class="fa fa-check"></i><b>3.2.4</b> Some notes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="two-way-anova.html"><a href="two-way-anova.html"><i class="fa fa-check"></i><b>4</b> Two-Way ANOVA</a><ul>
<li class="chapter" data-level="4.1" data-path="two-way-anova.html"><a href="two-way-anova.html#sas-example-2"><i class="fa fa-check"></i><b>4.1</b> SAS example</a></li>
<li class="chapter" data-level="4.2" data-path="two-way-anova.html"><a href="two-way-anova.html#sample-result-1"><i class="fa fa-check"></i><b>4.2</b> Sample Result</a><ul>
<li class="chapter" data-level="4.2.1" data-path="two-way-anova.html"><a href="two-way-anova.html#some-notes-1"><i class="fa fa-check"></i><b>4.2.1</b> Some notes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="two-way-anova.html"><a href="two-way-anova.html#least-squares-mean-ls-mean"><i class="fa fa-check"></i><b>4.3</b> Least Squares Mean (LS-mean)</a></li>
<li class="chapter" data-level="4.4" data-path="two-way-anova.html"><a href="two-way-anova.html#unbalanced-two-way-anova"><i class="fa fa-check"></i><b>4.4</b> Unbalanced Two-way ANOVA</a></li>
<li class="chapter" data-level="4.5" data-path="two-way-anova.html"><a href="two-way-anova.html#some-notes-2"><i class="fa fa-check"></i><b>4.5</b> Some notes</a><ul>
<li class="chapter" data-level="4.5.1" data-path="two-way-anova.html"><a href="two-way-anova.html#mixed-effects"><i class="fa fa-check"></i><b>4.5.1</b> “Mixed” effects</a></li>
<li class="chapter" data-level="4.5.2" data-path="two-way-anova.html"><a href="two-way-anova.html#using-proc-mixed"><i class="fa fa-check"></i><b>4.5.2</b> Using Proc Mixed</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i><b>5</b> Repeated Measures</a><ul>
<li class="chapter" data-level="5.1" data-path="repeated-measures.html"><a href="repeated-measures.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="repeated-measures.html"><a href="repeated-measures.html#sas-example-3"><i class="fa fa-check"></i><b>5.2</b> SAS example</a></li>
<li class="chapter" data-level="5.3" data-path="repeated-measures.html"><a href="repeated-measures.html#example-from-trial"><i class="fa fa-check"></i><b>5.3</b> Example from trial</a><ul>
<li class="chapter" data-level="5.3.1" data-path="repeated-measures.html"><a href="repeated-measures.html#sample-mmrm-program"><i class="fa fa-check"></i><b>5.3.1</b> Sample MMRM program</a></li>
<li class="chapter" data-level="5.3.2" data-path="repeated-measures.html"><a href="repeated-measures.html#sample-mmrm-output"><i class="fa fa-check"></i><b>5.3.2</b> Sample MMRM output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>6</b> Linear Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="linear-regression.html"><a href="linear-regression.html#some-notes-3"><i class="fa fa-check"></i><b>6.2</b> Some notes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>7</b> Analysis of Covariance</a><ul>
<li class="chapter" data-level="7.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#sas-example-4"><i class="fa fa-check"></i><b>7.2</b> SAS Example</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-binomial-test.html"><a href="the-binomial-test.html"><i class="fa fa-check"></i><b>8</b> The Binomial Test</a><ul>
<li class="chapter" data-level="8.1" data-path="the-binomial-test.html"><a href="the-binomial-test.html#overview"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="the-binomial-test.html"><a href="the-binomial-test.html#normal-approximation"><i class="fa fa-check"></i><b>8.2</b> Normal Approximation</a></li>
<li class="chapter" data-level="8.3" data-path="the-binomial-test.html"><a href="the-binomial-test.html#a-proc-freq-example"><i class="fa fa-check"></i><b>8.3</b> A proc freq example</a><ul>
<li class="chapter" data-level="8.3.1" data-path="the-binomial-test.html"><a href="the-binomial-test.html#a-real-example-from-trial"><i class="fa fa-check"></i><b>8.3.1</b> A real example from trial</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="the-binomial-test.html"><a href="the-binomial-test.html#the-chi-square-test"><i class="fa fa-check"></i><b>8.4</b> The Chi-Square Test</a></li>
<li class="chapter" data-level="8.5" data-path="the-binomial-test.html"><a href="the-binomial-test.html#cmh"><i class="fa fa-check"></i><b>8.5</b> CMH</a></li>
<li class="chapter" data-level="8.6" data-path="the-binomial-test.html"><a href="the-binomial-test.html#fishers-exact-test"><i class="fa fa-check"></i><b>8.6</b> Fisher’s exact test</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Clinical Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analysis-of-covariance" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Analysis of Covariance</h1>
<div id="introduction-2" class="section level2">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p>Analysis of covariance (ANCOVA) provides a method for comparing <strong>response means</strong> among two or more groups adjusted for a quantitative concomitant variable, or ‘covariate’, thought to influence the response. The attention here is <strong>confined to</strong> cases in which the response, y, might be <strong>linearly related to the covariate, x</strong>.</p>
<blockquote>
<p>ANCOVA combines regression and ANOVA methods by fitting simple linear regression models within each group and comparing regressions among groups.</p>
</blockquote>
<p>Some examples:
+ comparing cholesterol levels (y) between a treated group and a reference group adjusted for age (x, in years)
+ comparing scar healing (y) between conventional and laser surgery adjusted for excision size (x, in mm)
+ comparing exercise tolerance (y) in 3 dose levels of a treatment used for angina patients adjusted for smoking habits (x, in cigarettes/day).</p>
<blockquote>
<p>ANCOVA can often increase the precision of comparisons of the group means by including the covariate, x, as a source of variation, thereby decreasing the estimated error variance.</p>
</blockquote>
<blockquote>
<p>ANCOVA is especially useful when the values of the covariate differ among the groups. When this occurs and the response is linearly related to the covariate, covariance adjustments can lead to markedly different conclusions than those obtained using the unadjusted ANOVA methods.</p>
</blockquote>
</div>
<div id="sas-example-4" class="section level2">
<h2><span class="header-section-number">7.2</span> SAS Example</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb1-1"><a href="analysis-of-covariance.html#cb1-1"></a>data tri;</span>
<span id="cb1-2"><a href="analysis-of-covariance.html#cb1-2"></a>  input trt $ pat hgba1c trichg @@;</span>
<span id="cb1-3"><a href="analysis-of-covariance.html#cb1-3"></a>  datalines;</span>
<span id="cb1-4"><a href="analysis-of-covariance.html#cb1-4"></a>  FIB 2 7.0 5 FIB 4 6.0 10 FIB 7 7.1 -5</span>
<span id="cb1-5"><a href="analysis-of-covariance.html#cb1-5"></a>  FIB 8 8.6 -20 FIB 11 6.3 0 FIB 13 7.5 -15</span>
<span id="cb1-6"><a href="analysis-of-covariance.html#cb1-6"></a>  FIB 16 6.6 10 FIB 17 7.4 -10 FIB 19 5.3 20</span>
<span id="cb1-7"><a href="analysis-of-covariance.html#cb1-7"></a>  FIB 21 6.5 -15 FIB 23 6.2 5 FIB 24 7.8 0</span>
<span id="cb1-8"><a href="analysis-of-covariance.html#cb1-8"></a>  FIB 27 8.5 -40 FIB 28 9.2 -25 FIB 30 5.0 25</span>
<span id="cb1-9"><a href="analysis-of-covariance.html#cb1-9"></a>  FIB 33 7.0 -10 GEM 1 5.1 10 GEM 3 6.0 15</span>
<span id="cb1-10"><a href="analysis-of-covariance.html#cb1-10"></a>  GEM 5 7.2 -15 GEM 6 6.4 5 GEM 9 5.5 10</span>
<span id="cb1-11"><a href="analysis-of-covariance.html#cb1-11"></a>  GEM 10 6.0 -15 GEM 12 5.6 -5 GEM 14 5.5 -10</span>
<span id="cb1-12"><a href="analysis-of-covariance.html#cb1-12"></a>  GEM 15 6.7 -20 GEM 18 8.6 -40 GEM 20 6.4 -5</span>
<span id="cb1-13"><a href="analysis-of-covariance.html#cb1-13"></a>  GEM 22 6.0 -10 GEM 25 9.3 -40 GEM 26 8.5 -20</span>
<span id="cb1-14"><a href="analysis-of-covariance.html#cb1-14"></a>  GEM 29 7.9 -35 GEM 31 7.4 0 GEM 32 5.0 0</span>
<span id="cb1-15"><a href="analysis-of-covariance.html#cb1-15"></a>  GEM 34 6.5 -10</span>
<span id="cb1-16"><a href="analysis-of-covariance.html#cb1-16"></a>  ;</span>
<span id="cb1-17"><a href="analysis-of-covariance.html#cb1-17"></a>run;</span>
<span id="cb1-18"><a href="analysis-of-covariance.html#cb1-18"></a></span>
<span id="cb1-19"><a href="analysis-of-covariance.html#cb1-19"></a>proc sort data=tri;</span>
<span id="cb1-20"><a href="analysis-of-covariance.html#cb1-20"></a>  by trt hgba1c trichg;</span>
<span id="cb1-21"><a href="analysis-of-covariance.html#cb1-21"></a>run;</span>
<span id="cb1-22"><a href="analysis-of-covariance.html#cb1-22"></a></span>
<span id="cb1-23"><a href="analysis-of-covariance.html#cb1-23"></a>proc means data=tri mean std n;</span>
<span id="cb1-24"><a href="analysis-of-covariance.html#cb1-24"></a>  by trt;</span>
<span id="cb1-25"><a href="analysis-of-covariance.html#cb1-25"></a>  var hgba1c trichg;</span>
<span id="cb1-26"><a href="analysis-of-covariance.html#cb1-26"></a>run;</span>
<span id="cb1-27"><a href="analysis-of-covariance.html#cb1-27"></a></span>
<span id="cb1-28"><a href="analysis-of-covariance.html#cb1-28"></a>/* use hgba1c as covariate */</span>
<span id="cb1-29"><a href="analysis-of-covariance.html#cb1-29"></a>proc glm data=tri;</span>
<span id="cb1-30"><a href="analysis-of-covariance.html#cb1-30"></a>  class trt;</span>
<span id="cb1-31"><a href="analysis-of-covariance.html#cb1-31"></a>  model trichg = trt hgba1c / solution; /* solution: obtains the estimates</span>
<span id="cb1-32"><a href="analysis-of-covariance.html#cb1-32"></a>for the regression equations*/</span>
<span id="cb1-33"><a href="analysis-of-covariance.html#cb1-33"></a>  lsmeans trt/pdiff stderr cl;</span>
<span id="cb1-34"><a href="analysis-of-covariance.html#cb1-34"></a>run;</span>
<span id="cb1-35"><a href="analysis-of-covariance.html#cb1-35"></a>quit;</span>
<span id="cb1-36"><a href="analysis-of-covariance.html#cb1-36"></a></span>
<span id="cb1-37"><a href="analysis-of-covariance.html#cb1-37"></a>/* compare groups with ANOVA, ignoring the covariate */</span>
<span id="cb1-38"><a href="analysis-of-covariance.html#cb1-38"></a>proc glm data=tri;</span>
<span id="cb1-39"><a href="analysis-of-covariance.html#cb1-39"></a>  class trt;</span>
<span id="cb1-40"><a href="analysis-of-covariance.html#cb1-40"></a>  model trichg = trt/ss3;</span>
<span id="cb1-41"><a href="analysis-of-covariance.html#cb1-41"></a>run;</span>
<span id="cb1-42"><a href="analysis-of-covariance.html#cb1-42"></a>quit;</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-binomial-test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": true,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CDA.pdf", "CDA.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
